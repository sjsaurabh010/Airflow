[2025-10-25T06:38:51.527+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-10-25T06:38:51.553+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: full_integration_test.test_complex_task manual__2025-10-25T06:32:43.058270+00:00 [queued]>
[2025-10-25T06:38:51.566+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: full_integration_test.test_complex_task manual__2025-10-25T06:32:43.058270+00:00 [queued]>
[2025-10-25T06:38:51.567+0000] {taskinstance.py:2865} INFO - Starting attempt 2 of 2
[2025-10-25T06:38:51.583+0000] {taskinstance.py:2888} INFO - Executing <Task(SmartRemoteWorkerOperatorV2): test_complex_task> on 2025-10-25 06:32:43.058270+00:00
[2025-10-25T06:38:51.591+0000] {warnings.py:110} WARNING - /home/airflow/airflow-env/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=132475) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2025-10-25T06:38:51.592+0000] {standard_task_runner.py:72} INFO - Started process 132487 to run task
[2025-10-25T06:38:51.593+0000] {standard_task_runner.py:104} INFO - Running: ['airflow', 'tasks', 'run', 'full_integration_test', 'test_complex_task', 'manual__2025-10-25T06:32:43.058270+00:00', '--job-id', '137', '--raw', '--subdir', 'DAGS_FOLDER/full_integration_test.py', '--cfg-path', '/tmp/tmppsvblqna']
[2025-10-25T06:38:51.595+0000] {standard_task_runner.py:105} INFO - Job 137: Subtask test_complex_task
[2025-10-25T06:38:51.655+0000] {task_command.py:467} INFO - Running <TaskInstance: full_integration_test.test_complex_task manual__2025-10-25T06:32:43.058270+00:00 [running]> on host masterdimpal-1
[2025-10-25T06:38:51.743+0000] {taskinstance.py:3131} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='full_integration_test' AIRFLOW_CTX_TASK_ID='test_complex_task' AIRFLOW_CTX_EXECUTION_DATE='2025-10-25T06:32:43.058270+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-10-25T06:32:43.058270+00:00'
[2025-10-25T06:38:51.744+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-10-25T06:38:51.758+0000] {smart_remote_worker_v2.py:254} INFO - ================================================================================
[2025-10-25T06:38:51.758+0000] {smart_remote_worker_v2.py:255} INFO - üöÄ Smart Remote Worker Operator V2 - Starting
[2025-10-25T06:38:51.758+0000] {smart_remote_worker_v2.py:256} INFO - ================================================================================
[2025-10-25T06:38:51.771+0000] {smart_remote_worker_v2.py:57} INFO - üìã Loaded 1 workers from registry
[2025-10-25T06:38:51.771+0000] {smart_remote_worker_v2.py:264} INFO - üìã Selected 1 worker(s)
[2025-10-25T06:38:51.771+0000] {smart_remote_worker_v2.py:266} INFO -    - worker-1 (priority: 1, host: 45.151.155.74)
[2025-10-25T06:38:51.772+0000] {smart_remote_worker_v2.py:272} INFO - ================================================================================
[2025-10-25T06:38:51.772+0000] {smart_remote_worker_v2.py:273} INFO - üéØ ATTEMPT 1/1: Trying worker 'worker-1'
[2025-10-25T06:38:51.772+0000] {smart_remote_worker_v2.py:274} INFO - ================================================================================
[2025-10-25T06:38:51.772+0000] {smart_remote_worker_v2.py:194} INFO - üéØ Executing on worker: worker-1
[2025-10-25T06:38:51.772+0000] {smart_remote_worker_v2.py:195} INFO -    Host: 45.151.155.74
[2025-10-25T06:38:51.772+0000] {smart_remote_worker_v2.py:196} INFO -    AIRFLOW_HOME: /home/airflow/airflow-worker
[2025-10-25T06:38:51.786+0000] {smart_remote_worker_v2.py:125} INFO - ‚úÖ Using existing SSH connection: worker_worker-1
[2025-10-25T06:38:51.800+0000] {base.py:84} INFO - Retrieving connection 'worker_worker-1'
[2025-10-25T06:38:51.800+0000] {smart_remote_worker_v2.py:208} INFO - üì§ Executing command via SSH...
[2025-10-25T06:38:51.800+0000] {smart_remote_worker_v2.py:209} INFO - Command:
#!/bin/bash
set -x

# Setup environment
export AIRFLOW_HOME=/home/airflow/airflow-worker
export WORKER_NAME=worker-1
export QUEUE_NAME=default

echo "====================================="
echo "Starting worker: $WORKER_NAME"
echo "AIRFLOW_HOME: $AIRFLOW_HOME"
echo "====================================="

# Go to Airflow directory
cd $AIRFLOW_HOME || exit 1

# Check for Singularity container
SINGULARITY_IMAGE=""
if [ -f "containers/airflow-worker.sif" ]; then
    SINGULARITY_IMAGE="containers/ai...
[2025-10-25T06:38:51.803+0000] {ssh.py:309} WARNING - No Host Key Verification. This won't protect against Man-In-The-Middle attacks
[2025-10-25T06:38:51.814+0000] {transport.py:1944} INFO - Connected (version 2.0, client OpenSSH_9.6p1)
[2025-10-25T06:38:51.912+0000] {transport.py:1944} INFO - Authentication (publickey) successful!
[2025-10-25T06:38:52.300+0000] {smart_remote_worker_v2.py:221} INFO - üìä Exit status: 2
[2025-10-25T06:38:52.301+0000] {smart_remote_worker_v2.py:224} INFO - üìÑ Output:
=====================================
Starting worker: worker-1
AIRFLOW_HOME: /home/airflow/airflow-worker
=====================================

[2025-10-25T06:38:52.301+0000] {smart_remote_worker_v2.py:227} INFO - ‚ö†Ô∏è Stderr:
+ export AIRFLOW_HOME=/home/airflow/airflow-worker
+ AIRFLOW_HOME=/home/airflow/airflow-worker
+ export WORKER_NAME=worker-1
+ WORKER_NAME=worker-1
+ export QUEUE_NAME=default
+ QUEUE_NAME=default
+ echo =====================================
+ echo 'Starting worker: worker-1'
+ echo 'AIRFLOW_HOME: /home/airflow/airflow-worker'
+ echo =====================================
+ cd /home/airflow/airflow-worker
+ SINGULARITY_IMAGE=
+ '[' -f containers/airflow-worker.sif ']'
+ SINGULARITY_IMAGE=containers/airflow-worker.sif
bash: -c: line 37: syntax error near unexpected token `('
bash: -c: line 37: `echo "=========================================="; echo "TEST 3: Complex Task Execution"; echo "=========================================="; echo ""; python3 -c "import json; import time; import socket; print('Simulating complex data processing task...'); print(''); data = {'worker': socket.gethostname(), 'timestamp': time.time(), 'records_processed': 0, 'status': 'processing'}; print(f'Worker: {data[\"worker\"]}'); print(f'Started at: {time.strftime(\"%Y-%m-%d %H:%M:%S\", time.localtime(data[\"timestamp\"]))}'); print(''); [print(f'Processing batch {i}/5...') or time.sleep(0.5) or data.update({'records_processed': data['records_processed'] + 100}) for i in range(1, 6)]; data.update({'status': 'completed', 'completed_at': time.time()}); print(''); print(f'‚úÖ Processed {data[\"records_processed\"]} records'); print(f'‚úÖ Duration: {data[\"completed_at\"] - data[\"timestamp\"]:.2f} seconds'); print(''); print('Output data:'); print(json.dumps(data, indent=2)); print(''); print('üéâ Complex task test: PASSED')"; echo ""; echo "=========================================="'

[2025-10-25T06:38:52.301+0000] {smart_remote_worker_v2.py:248} ERROR - ‚ùå Failed to execute on worker-1: Command failed with exit code 2
Output: =====================================
Starting worker: worker-1
AIRFLOW_HOME: /home/airflow/airflow-worker
=====================================

Error: + export AIRFLOW_HOME=/home/airflow/airflow-worker
+ AIRFLOW_HOME=/home/airflow/airflow-worker
+ export WORKER_NAME=worker-1
+ WORKER_NAME=worker-1
+ export QUEUE_NAME=default
+ QUEUE_NAME=default
+ echo =====================================
+ echo 'Starting worker: worker-1'
+ echo 'AIRFLOW_HOME: /home/airflow/airflow-worker'
+ echo =====================================
+ cd /home/airflow/airflow-worker
+ SINGULARITY_IMAGE=
+ '[' -f containers/airflow-worker.sif ']'
+ SINGULARITY_IMAGE=containers/airflow-worker.sif
bash: -c: line 37: syntax error near unexpected token `('
bash: -c: line 37: `echo "=========================================="; echo "TEST 3: Complex Task Execution"; echo "=========================================="; echo ""; python3 -c "import json; import time; import socket; print('Simulating complex data processing task...'); print(''); data = {'worker': socket.gethostname(), 'timestamp': time.time(), 'records_processed': 0, 'status': 'processing'}; print(f'Worker: {data[\"worker\"]}'); print(f'Started at: {time.strftime(\"%Y-%m-%d %H:%M:%S\", time.localtime(data[\"timestamp\"]))}'); print(''); [print(f'Processing batch {i}/5...') or time.sleep(0.5) or data.update({'records_processed': data['records_processed'] + 100}) for i in range(1, 6)]; data.update({'status': 'completed', 'completed_at': time.time()}); print(''); print(f'‚úÖ Processed {data[\"records_processed\"]} records'); print(f'‚úÖ Duration: {data[\"completed_at\"] - data[\"timestamp\"]:.2f} seconds'); print(''); print('Output data:'); print(json.dumps(data, indent=2)); print(''); print('üéâ Complex task test: PASSED')"; echo ""; echo "=========================================="'

[2025-10-25T06:38:52.301+0000] {smart_remote_worker_v2.py:287} WARNING - ‚ö†Ô∏è Worker 'worker-1' failed: Command failed with exit code 2
Output: =====================================
Starting worker: worker-1
AIRFLOW_HOME: /home/airflow/airflow-worker
=====================================

Error: + export AIRFLOW_HOME=/home/airflow/airflow-worker
+ AIRFLOW_HOME=/home/airflow/airflow-worker
+ export WORKER_NAME=worker-1
+ WORKER_NAME=worker-1
+ export QUEUE_NAME=default
+ QUEUE_NAME=default
+ echo =====================================
+ echo 'Starting worker: worker-1'
+ echo 'AIRFLOW_HOME: /home/airflow/airflow-worker'
+ echo =====================================
+ cd /home/airflow/airflow-worker
+ SINGULARITY_IMAGE=
+ '[' -f containers/airflow-worker.sif ']'
+ SINGULARITY_IMAGE=containers/airflow-worker.sif
bash: -c: line 37: syntax error near unexpected token `('
bash: -c: line 37: `echo "=========================================="; echo "TEST 3: Complex Task Execution"; echo "=========================================="; echo ""; python3 -c "import json; import time; import socket; print('Simulating complex data processing task...'); print(''); data = {'worker': socket.gethostname(), 'timestamp': time.time(), 'records_processed': 0, 'status': 'processing'}; print(f'Worker: {data[\"worker\"]}'); print(f'Started at: {time.strftime(\"%Y-%m-%d %H:%M:%S\", time.localtime(data[\"timestamp\"]))}'); print(''); [print(f'Processing batch {i}/5...') or time.sleep(0.5) or data.update({'records_processed': data['records_processed'] + 100}) for i in range(1, 6)]; data.update({'status': 'completed', 'completed_at': time.time()}); print(''); print(f'‚úÖ Processed {data[\"records_processed\"]} records'); print(f'‚úÖ Duration: {data[\"completed_at\"] - data[\"timestamp\"]:.2f} seconds'); print(''); print('Output data:'); print(json.dumps(data, indent=2)); print(''); print('üéâ Complex task test: PASSED')"; echo ""; echo "=========================================="'

[2025-10-25T06:38:52.302+0000] {smart_remote_worker_v2.py:296} INFO - ‚è≥ Retrying after 300 seconds...
[2025-10-25T06:43:52.302+0000] {smart_remote_worker_v2.py:194} INFO - üéØ Executing on worker: worker-1
[2025-10-25T06:43:52.303+0000] {smart_remote_worker_v2.py:195} INFO -    Host: 45.151.155.74
[2025-10-25T06:43:52.303+0000] {smart_remote_worker_v2.py:196} INFO -    AIRFLOW_HOME: /home/airflow/airflow-worker
[2025-10-25T06:43:52.315+0000] {smart_remote_worker_v2.py:125} INFO - ‚úÖ Using existing SSH connection: worker_worker-1
[2025-10-25T06:43:52.326+0000] {base.py:84} INFO - Retrieving connection 'worker_worker-1'
[2025-10-25T06:43:52.327+0000] {smart_remote_worker_v2.py:208} INFO - üì§ Executing command via SSH...
[2025-10-25T06:43:52.327+0000] {smart_remote_worker_v2.py:209} INFO - Command:
#!/bin/bash
set -x

# Setup environment
export AIRFLOW_HOME=/home/airflow/airflow-worker
export WORKER_NAME=worker-1
export QUEUE_NAME=default

echo "====================================="
echo "Starting worker: $WORKER_NAME"
echo "AIRFLOW_HOME: $AIRFLOW_HOME"
echo "====================================="

# Go to Airflow directory
cd $AIRFLOW_HOME || exit 1

# Check for Singularity container
SINGULARITY_IMAGE=""
if [ -f "containers/airflow-worker.sif" ]; then
    SINGULARITY_IMAGE="containers/ai...
[2025-10-25T06:43:52.328+0000] {ssh.py:309} WARNING - No Host Key Verification. This won't protect against Man-In-The-Middle attacks
[2025-10-25T06:43:52.339+0000] {transport.py:1944} INFO - Connected (version 2.0, client OpenSSH_9.6p1)
[2025-10-25T06:43:52.444+0000] {transport.py:1944} INFO - Authentication (publickey) successful!
[2025-10-25T06:43:52.836+0000] {smart_remote_worker_v2.py:221} INFO - üìä Exit status: 2
[2025-10-25T06:43:52.837+0000] {smart_remote_worker_v2.py:224} INFO - üìÑ Output:
=====================================
Starting worker: worker-1
AIRFLOW_HOME: /home/airflow/airflow-worker
=====================================

[2025-10-25T06:43:52.837+0000] {smart_remote_worker_v2.py:227} INFO - ‚ö†Ô∏è Stderr:
+ export AIRFLOW_HOME=/home/airflow/airflow-worker
+ AIRFLOW_HOME=/home/airflow/airflow-worker
+ export WORKER_NAME=worker-1
+ WORKER_NAME=worker-1
+ export QUEUE_NAME=default
+ QUEUE_NAME=default
+ echo =====================================
+ echo 'Starting worker: worker-1'
+ echo 'AIRFLOW_HOME: /home/airflow/airflow-worker'
+ echo =====================================
+ cd /home/airflow/airflow-worker
+ SINGULARITY_IMAGE=
+ '[' -f containers/airflow-worker.sif ']'
+ SINGULARITY_IMAGE=containers/airflow-worker.sif
bash: -c: line 37: syntax error near unexpected token `('
bash: -c: line 37: `echo "=========================================="; echo "TEST 3: Complex Task Execution"; echo "=========================================="; echo ""; python3 -c "import json; import time; import socket; print('Simulating complex data processing task...'); print(''); data = {'worker': socket.gethostname(), 'timestamp': time.time(), 'records_processed': 0, 'status': 'processing'}; print(f'Worker: {data[\"worker\"]}'); print(f'Started at: {time.strftime(\"%Y-%m-%d %H:%M:%S\", time.localtime(data[\"timestamp\"]))}'); print(''); [print(f'Processing batch {i}/5...') or time.sleep(0.5) or data.update({'records_processed': data['records_processed'] + 100}) for i in range(1, 6)]; data.update({'status': 'completed', 'completed_at': time.time()}); print(''); print(f'‚úÖ Processed {data[\"records_processed\"]} records'); print(f'‚úÖ Duration: {data[\"completed_at\"] - data[\"timestamp\"]:.2f} seconds'); print(''); print('Output data:'); print(json.dumps(data, indent=2)); print(''); print('üéâ Complex task test: PASSED')"; echo ""; echo "=========================================="'

[2025-10-25T06:43:52.837+0000] {smart_remote_worker_v2.py:248} ERROR - ‚ùå Failed to execute on worker-1: Command failed with exit code 2
Output: =====================================
Starting worker: worker-1
AIRFLOW_HOME: /home/airflow/airflow-worker
=====================================

Error: + export AIRFLOW_HOME=/home/airflow/airflow-worker
+ AIRFLOW_HOME=/home/airflow/airflow-worker
+ export WORKER_NAME=worker-1
+ WORKER_NAME=worker-1
+ export QUEUE_NAME=default
+ QUEUE_NAME=default
+ echo =====================================
+ echo 'Starting worker: worker-1'
+ echo 'AIRFLOW_HOME: /home/airflow/airflow-worker'
+ echo =====================================
+ cd /home/airflow/airflow-worker
+ SINGULARITY_IMAGE=
+ '[' -f containers/airflow-worker.sif ']'
+ SINGULARITY_IMAGE=containers/airflow-worker.sif
bash: -c: line 37: syntax error near unexpected token `('
bash: -c: line 37: `echo "=========================================="; echo "TEST 3: Complex Task Execution"; echo "=========================================="; echo ""; python3 -c "import json; import time; import socket; print('Simulating complex data processing task...'); print(''); data = {'worker': socket.gethostname(), 'timestamp': time.time(), 'records_processed': 0, 'status': 'processing'}; print(f'Worker: {data[\"worker\"]}'); print(f'Started at: {time.strftime(\"%Y-%m-%d %H:%M:%S\", time.localtime(data[\"timestamp\"]))}'); print(''); [print(f'Processing batch {i}/5...') or time.sleep(0.5) or data.update({'records_processed': data['records_processed'] + 100}) for i in range(1, 6)]; data.update({'status': 'completed', 'completed_at': time.time()}); print(''); print(f'‚úÖ Processed {data[\"records_processed\"]} records'); print(f'‚úÖ Duration: {data[\"completed_at\"] - data[\"timestamp\"]:.2f} seconds'); print(''); print('Output data:'); print(json.dumps(data, indent=2)); print(''); print('üéâ Complex task test: PASSED')"; echo ""; echo "=========================================="'

[2025-10-25T06:43:52.837+0000] {smart_remote_worker_v2.py:306} ERROR - ‚ùå Retry also failed: Command failed with exit code 2
Output: =====================================
Starting worker: worker-1
AIRFLOW_HOME: /home/airflow/airflow-worker
=====================================

Error: + export AIRFLOW_HOME=/home/airflow/airflow-worker
+ AIRFLOW_HOME=/home/airflow/airflow-worker
+ export WORKER_NAME=worker-1
+ WORKER_NAME=worker-1
+ export QUEUE_NAME=default
+ QUEUE_NAME=default
+ echo =====================================
+ echo 'Starting worker: worker-1'
+ echo 'AIRFLOW_HOME: /home/airflow/airflow-worker'
+ echo =====================================
+ cd /home/airflow/airflow-worker
+ SINGULARITY_IMAGE=
+ '[' -f containers/airflow-worker.sif ']'
+ SINGULARITY_IMAGE=containers/airflow-worker.sif
bash: -c: line 37: syntax error near unexpected token `('
bash: -c: line 37: `echo "=========================================="; echo "TEST 3: Complex Task Execution"; echo "=========================================="; echo ""; python3 -c "import json; import time; import socket; print('Simulating complex data processing task...'); print(''); data = {'worker': socket.gethostname(), 'timestamp': time.time(), 'records_processed': 0, 'status': 'processing'}; print(f'Worker: {data[\"worker\"]}'); print(f'Started at: {time.strftime(\"%Y-%m-%d %H:%M:%S\", time.localtime(data[\"timestamp\"]))}'); print(''); [print(f'Processing batch {i}/5...') or time.sleep(0.5) or data.update({'records_processed': data['records_processed'] + 100}) for i in range(1, 6)]; data.update({'status': 'completed', 'completed_at': time.time()}); print(''); print(f'‚úÖ Processed {data[\"records_processed\"]} records'); print(f'‚úÖ Duration: {data[\"completed_at\"] - data[\"timestamp\"]:.2f} seconds'); print(''); print('Output data:'); print(json.dumps(data, indent=2)); print(''); print('üéâ Complex task test: PASSED')"; echo ""; echo "=========================================="'

[2025-10-25T06:43:52.838+0000] {smart_remote_worker_v2.py:309} ERROR - ================================================================================
[2025-10-25T06:43:52.838+0000] {smart_remote_worker_v2.py:310} ERROR - ‚ùå FAILURE: All workers failed
[2025-10-25T06:43:52.838+0000] {smart_remote_worker_v2.py:311} ERROR - ================================================================================
[2025-10-25T06:43:52.858+0000] {taskinstance.py:3310} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/airflow-env/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 767, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/airflow-env/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 733, in _execute_callable
    return ExecutionCallableRunner(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/airflow-env/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/airflow-env/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 406, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/airflow/dags/../plugins/operators/smart_remote_worker_v2.py", line 313, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Task failed on all available workers. Tried 1 worker(s): ['worker-1']. Last error: Command failed with exit code 2
Output: =====================================
Starting worker: worker-1
AIRFLOW_HOME: /home/airflow/airflow-worker
=====================================

Error: + export AIRFLOW_HOME=/home/airflow/airflow-worker
+ AIRFLOW_HOME=/home/airflow/airflow-worker
+ export WORKER_NAME=worker-1
+ WORKER_NAME=worker-1
+ export QUEUE_NAME=default
+ QUEUE_NAME=default
+ echo =====================================
+ echo 'Starting worker: worker-1'
+ echo 'AIRFLOW_HOME: /home/airflow/airflow-worker'
+ echo =====================================
+ cd /home/airflow/airflow-worker
+ SINGULARITY_IMAGE=
+ '[' -f containers/airflow-worker.sif ']'
+ SINGULARITY_IMAGE=containers/airflow-worker.sif
bash: -c: line 37: syntax error near unexpected token `('
bash: -c: line 37: `echo "=========================================="; echo "TEST 3: Complex Task Execution"; echo "=========================================="; echo ""; python3 -c "import json; import time; import socket; print('Simulating complex data processing task...'); print(''); data = {'worker': socket.gethostname(), 'timestamp': time.time(), 'records_processed': 0, 'status': 'processing'}; print(f'Worker: {data[\"worker\"]}'); print(f'Started at: {time.strftime(\"%Y-%m-%d %H:%M:%S\", time.localtime(data[\"timestamp\"]))}'); print(''); [print(f'Processing batch {i}/5...') or time.sleep(0.5) or data.update({'records_processed': data['records_processed'] + 100}) for i in range(1, 6)]; data.update({'status': 'completed', 'completed_at': time.time()}); print(''); print(f'‚úÖ Processed {data[\"records_processed\"]} records'); print(f'‚úÖ Duration: {data[\"completed_at\"] - data[\"timestamp\"]:.2f} seconds'); print(''); print('Output data:'); print(json.dumps(data, indent=2)); print(''); print('üéâ Complex task test: PASSED')"; echo ""; echo "=========================================="'

[2025-10-25T06:43:52.865+0000] {taskinstance.py:1225} INFO - Marking task as FAILED. dag_id=full_integration_test, task_id=test_complex_task, run_id=manual__2025-10-25T06:32:43.058270+00:00, execution_date=20251025T063243, start_date=20251025T063851, end_date=20251025T064352
[2025-10-25T06:43:52.879+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2025-10-25T06:43:52.880+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 137 for task test_complex_task (Task failed on all available workers. Tried 1 worker(s): ['worker-1']. Last error: Command failed with exit code 2
Output: =====================================
Starting worker: worker-1
AIRFLOW_HOME: /home/airflow/airflow-worker
=====================================

Error: + export AIRFLOW_HOME=/home/airflow/airflow-worker
+ AIRFLOW_HOME=/home/airflow/airflow-worker
+ export WORKER_NAME=worker-1
+ WORKER_NAME=worker-1
+ export QUEUE_NAME=default
+ QUEUE_NAME=default
+ echo =====================================
+ echo 'Starting worker: worker-1'
+ echo 'AIRFLOW_HOME: /home/airflow/airflow-worker'
+ echo =====================================
+ cd /home/airflow/airflow-worker
+ SINGULARITY_IMAGE=
+ '[' -f containers/airflow-worker.sif ']'
+ SINGULARITY_IMAGE=containers/airflow-worker.sif
bash: -c: line 37: syntax error near unexpected token `('
bash: -c: line 37: `echo "=========================================="; echo "TEST 3: Complex Task Execution"; echo "=========================================="; echo ""; python3 -c "import json; import time; import socket; print('Simulating complex data processing task...'); print(''); data = {'worker': socket.gethostname(), 'timestamp': time.time(), 'records_processed': 0, 'status': 'processing'}; print(f'Worker: {data[\"worker\"]}'); print(f'Started at: {time.strftime(\"%Y-%m-%d %H:%M:%S\", time.localtime(data[\"timestamp\"]))}'); print(''); [print(f'Processing batch {i}/5...') or time.sleep(0.5) or data.update({'records_processed': data['records_processed'] + 100}) for i in range(1, 6)]; data.update({'status': 'completed', 'completed_at': time.time()}); print(''); print(f'‚úÖ Processed {data[\"records_processed\"]} records'); print(f'‚úÖ Duration: {data[\"completed_at\"] - data[\"timestamp\"]:.2f} seconds'); print(''); print('Output data:'); print(json.dumps(data, indent=2)); print(''); print('üéâ Complex task test: PASSED')"; echo ""; echo "=========================================="'
; 132487)
Traceback (most recent call last):
  File "/home/airflow/airflow-env/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py", line 117, in _start_by_fork
    ret = args.func(args, dag=self.dag)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/airflow-env/lib/python3.12/site-packages/airflow/cli/cli_config.py", line 49, in command
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/airflow-env/lib/python3.12/site-packages/airflow/utils/cli.py", line 115, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/airflow-env/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 483, in task_run
    task_return_code = _run_task_by_selected_method(args, _dag, ti)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/airflow-env/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 256, in _run_task_by_selected_method
    return _run_raw_task(args, ti)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/airflow-env/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 341, in _run_raw_task
    return ti._run_raw_task(
           ^^^^^^^^^^^^^^^^^
  File "/home/airflow/airflow-env/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/airflow-env/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3004, in _run_raw_task
    return _run_raw_task(
           ^^^^^^^^^^^^^^
  File "/home/airflow/airflow-env/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 273, in _run_raw_task
    TaskInstance._execute_task_with_callbacks(
  File "/home/airflow/airflow-env/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3158, in _execute_task_with_callbacks
    result = self._execute_task(context, task_orig)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/airflow-env/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3182, in _execute_task
    return _execute_task(self, context, task_orig)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/airflow-env/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 767, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/airflow-env/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 733, in _execute_callable
    return ExecutionCallableRunner(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/airflow-env/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/airflow-env/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 406, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/airflow/dags/../plugins/operators/smart_remote_worker_v2.py", line 313, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Task failed on all available workers. Tried 1 worker(s): ['worker-1']. Last error: Command failed with exit code 2
Output: =====================================
Starting worker: worker-1
AIRFLOW_HOME: /home/airflow/airflow-worker
=====================================

Error: + export AIRFLOW_HOME=/home/airflow/airflow-worker
+ AIRFLOW_HOME=/home/airflow/airflow-worker
+ export WORKER_NAME=worker-1
+ WORKER_NAME=worker-1
+ export QUEUE_NAME=default
+ QUEUE_NAME=default
+ echo =====================================
+ echo 'Starting worker: worker-1'
+ echo 'AIRFLOW_HOME: /home/airflow/airflow-worker'
+ echo =====================================
+ cd /home/airflow/airflow-worker
+ SINGULARITY_IMAGE=
+ '[' -f containers/airflow-worker.sif ']'
+ SINGULARITY_IMAGE=containers/airflow-worker.sif
bash: -c: line 37: syntax error near unexpected token `('
bash: -c: line 37: `echo "=========================================="; echo "TEST 3: Complex Task Execution"; echo "=========================================="; echo ""; python3 -c "import json; import time; import socket; print('Simulating complex data processing task...'); print(''); data = {'worker': socket.gethostname(), 'timestamp': time.time(), 'records_processed': 0, 'status': 'processing'}; print(f'Worker: {data[\"worker\"]}'); print(f'Started at: {time.strftime(\"%Y-%m-%d %H:%M:%S\", time.localtime(data[\"timestamp\"]))}'); print(''); [print(f'Processing batch {i}/5...') or time.sleep(0.5) or data.update({'records_processed': data['records_processed'] + 100}) for i in range(1, 6)]; data.update({'status': 'completed', 'completed_at': time.time()}); print(''); print(f'‚úÖ Processed {data[\"records_processed\"]} records'); print(f'‚úÖ Duration: {data[\"completed_at\"] - data[\"timestamp\"]:.2f} seconds'); print(''); print('Output data:'); print(json.dumps(data, indent=2)); print(''); print('üéâ Complex task test: PASSED')"; echo ""; echo "=========================================="'

[2025-10-25T06:43:52.915+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1
[2025-10-25T06:43:52.944+0000] {taskinstance.py:3900} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-10-25T06:43:52.948+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
